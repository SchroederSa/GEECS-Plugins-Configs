# Example optimization configuration using MultiDeviceScanEvaluator
vocs:
  variables:
    U_S1H:Current: [-1.5, 1.5]   # control
#    U_S1V:Current: [-1.5, 1.5]5
    U_EMQTripletBipolar:Current_Limit.Ch1: [ .5, 2 ]
  objectives: {}  # EMPTY - BAX doesn't use objectives!
  observables:
    - x_CoM

# Evaluator: Specify the evaluator class and configuration
evaluator:
  # Module path to your custom evaluator
  # (Create a subclass of MultiDeviceScanEvaluator)
  module: geecs_scanner.optimization.evaluators.beam_position_evaluator_simulation
  class: BeamPositionEvaluator

  kwargs:
    # Custom evaluator parameters
    calibration: 1.0  # Spatial calibration in mm/pixel

    # Analyzer configurations (list of SingleDeviceScanAnalyzerConfig)
    analyzers:
      # Single device example: UC_ALineEBeam3 camera
      - device_name: UC_ALineEBeam3
        analyzer_type: Array2DScanAnalyzer  # or Array1DScanAnalyzer
        file_tail: .png  # File extension for data files

        # ImageAnalyzer configuration
        image_analyzer:
          module: image_analysis.offline_analyzers.beam_analyzer
          class: BeamAnalyzer
          kwargs: {"camera_config_name":"UC_ALineEBeam3"}

        # Analysis mode (per_bin recommended for optimization)
        analysis_mode: per_bin

generator:
  name: multipoint_bax_alignment_l2

xopt_config_overrides:
  multipoint_bax_alignment_l2:
    control_names: ["U_S1H:Current"]
    measurement_name: "U_EMQTripletBipolar:Current_Limit.Ch1"
    observable_names: ["x_CoM"]
    probe_nominal: 1.25
    probe_grid_absolute: [-0.25, 0.0, +0.25]
    n_control_mesh: 21
    mesh_measurement: true
    n_measurement_mesh: 5  # adjust as needed
    n_monte_carlo_samples: 32
    use_low_noise_prior: false